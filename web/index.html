<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>ChatGPT Team Invitation Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f5f5f7;
      --card-bg: rgba(255, 255, 255, 0.65);
      --accent: #0071e3;
      --accent-hover: #0077ed;
      --text-main: #1d1d1f;
      --text-secondary: #86868b;
      --error: #ff3b30;
      --success: #34c759;
      --input-bg: rgba(255, 255, 255, 0.4);
      --input-focus-bg: rgba(255, 255, 255, 0.9);
      --border-radius-l: 24px;
      --border-radius-m: 14px;
      --border-radius-s: 8px;
      --shadow-card: 0 24px 60px rgba(0, 0, 0, 0.1);
      --shadow-float: 0 8px 32px rgba(31, 38, 135, 0.15);
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
      background-color: #f0f2f5;
      background-image: 
        radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
        radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
        radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
      /* Lighter, Apple-esque abstract background */
      background: 
        radial-gradient(circle at 0% 0%, #e0f7fa 0%, transparent 40%),
        radial-gradient(circle at 100% 0%, #e1f5fe 0%, transparent 40%),
        radial-gradient(circle at 100% 100%, #f3e5f5 0%, transparent 40%),
        radial-gradient(circle at 0% 100%, #e8f5e9 0%, transparent 40%),
        #f5f5f7; /* Base color */
      
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* Ambient background blobs */
    body::before, body::after {
      content: '';
      position: fixed;
      border-radius: 50%;
      filter: blur(60px);
      z-index: -1;
      opacity: 0.6;
      animation: float 10s ease-in-out infinite;
    }
    
    body::before {
      width: 400px;
      height: 400px;
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      top: -100px;
      left: -100px;
    }

    body::after {
      width: 350px;
      height: 350px;
      background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
      bottom: -50px;
      right: -50px;
      animation-delay: -5s;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(20px, 40px); }
    }

    .container {
      width: 100%;
      max-width: 520px;
      background: var(--card-bg);
      backdrop-filter: saturate(180%) blur(20px);
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      border-radius: var(--border-radius-l);
      padding: 48px;
      box-shadow: 
        0 8px 32px 0 rgba(31, 38, 135, 0.07),
        inset 0 0 0 1px rgba(255, 255, 255, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 40px;
      position: relative;
    }

    .logo-area {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, #000000, #434343);
      border-radius: 18px;
      margin: 0 auto 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 32px;
      font-weight: 600;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    }

    h1 {
      font-size: 32px;
      font-weight: 700;
      margin: 0 0 12px;
      letter-spacing: -0.03em;
      color: #1d1d1f;
    }

    .badge {
      display: inline-block;
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 99px;
      background: rgba(0, 0, 0, 0.05);
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-top: 6px;
    }

    .subtitle {
      font-size: 17px;
      font-weight: 400;
      color: #86868b;
      line-height: 1.47059;
      margin-top: 12px;
      letter-spacing: -0.022em;
    }

    /* Language Switcher - Minimalist */
    .lang-selector {
      position: absolute;
      top: -30px;
      right: 0;
    }
    
    .lang-btn {
      background: transparent;
      border: none;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      padding: 6px 10px;
      border-radius: 8px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .lang-btn:hover {
      background: rgba(0,0,0,0.05);
      color: var(--text-main);
    }

    .lang-dropdown {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 6px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      min-width: 120px;
      z-index: 20;
      margin-top: 8px;
    }

    .lang-dropdown.show { display: block; animation: fadeIn 0.2s ease; }
    
    .lang-option {
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 13px;
      cursor: pointer;
      color: var(--text-main);
      transition: background 0.2s;
    }
    
    .lang-option:hover { background: rgba(0,0,0,0.05); }
    .lang-option.active { color: var(--accent); font-weight: 600; background: rgba(0, 113, 227, 0.08); }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(-4px); } to { opacity: 1; transform: translateY(0); } }

    /* Form Elements */
    .form-group { margin-bottom: 24px; }
    
    label {
      display: block;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #86868b;
      margin-bottom: 8px;
      padding-left: 4px;
    }
    
    label .desc {
      font-weight: 400;
      color: var(--text-secondary);
      float: right;
      font-size: 12px;
    }

    .input {
      width: 100%;
      padding: 18px 20px;
      border-radius: 16px;
      border: 1px solid rgba(0, 0, 0, 0.08); /* Subtle static border */
      background: rgba(255, 255, 255, 0.6);   /* Increased opacity */
      color: var(--text-main);
      font-size: 17px;
      font-weight: 400;
      outline: none;
      transition: all 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
      letter-spacing: -0.016em;
      /* Inner shadow for depth */
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); 
    }

    .input:hover {
      background: rgba(255, 255, 255, 0.8);
      border-color: rgba(0, 0, 0, 0.12);
    }

    .input:focus {
      background: #ffffff;
      border-color: var(--accent);
      box-shadow: 
        0 0 0 4px rgba(0, 113, 227, 0.15), /* Distinct focus ring */
        0 4px 12px rgba(0, 0, 0, 0.08);    /* Lift effect */
      transform: translateY(-1px);         /* Subtle lift */
    }

    .input:focus {
      background: var(--input-focus-bg);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transform: scale(1.01);
    }

    .input::placeholder { color: #a1a1a6; }
    
    .input.error {
      background: rgba(255, 59, 48, 0.08);
      color: var(--error);
    }
    
    .hint {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 8px;
      padding-left: 4px;
      line-height: 1.4;
    }

    /* Status Messages */
    .status {
      margin: 0 0 24px;
      padding: 14px 16px;
      border-radius: 14px;
      display: none;
      align-items: flex-start;
      gap: 12px;
      font-size: 13px;
      line-height: 1.5;
    }
    
    .status-success {
      background: rgba(52, 199, 89, 0.1);
      color: #1a8436;
    }
    
    .status-error {
      background: rgba(255, 59, 48, 0.1);
      color: #d70015;
    }
    
    .status-icon { font-size: 16px; }
    .status-title { font-weight: 600; margin-bottom: 2px; }

    /* Buttons */
    .actions {
      display: flex;
      gap: 12px;
      margin-top: 32px;
    }

    .btn-primary {
      flex: 2;
      height: 52px;
      border-radius: 14px;
      border: none;
      background: var(--accent);
      color: white;
      font-size: 17px;
      font-weight: 600;
      letter-spacing: -0.01em;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-primary:hover { background: var(--accent-hover); transform: scale(1.01); }
    .btn-primary:active { transform: scale(0.98); }
    .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

    .btn-secondary {
      flex: 1;
      height: 52px;
      border-radius: 14px;
      border: none;
      background: rgba(0,0,0,0.05);
      color: var(--text-main);
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-secondary:hover { background: rgba(0,0,0,0.08); }

    /* Footer & Flow */
    .footer {
      text-align: center;
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 24px;
      line-height: 1.6;
    }

    .usage-flow {
      margin-top: 48px;
      padding-top: 32px;
      border-top: 1px solid rgba(0,0,0,0.06);
    }

    .usage-flow-title {
      font-size: 13px;
      text-transform: uppercase;
      color: var(--text-secondary);
      letter-spacing: 0.05em;
      font-weight: 600;
      text-align: center;
      margin-bottom: 24px;
    }

    .flow-steps {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .flow-step {
      text-align: center;
      position: relative;
      padding: 0 4px;
    }

    .step-number {
      width: 28px;
      height: 28px;
      background: var(--bg);
      color: var(--text-secondary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      margin: 0 auto 12px;
    }

    .step-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--text-main);
      letter-spacing: -0.01em;
    }

    .step-desc {
      font-size: 11px;
      color: var(--text-secondary);
      line-height: 1.3;
    }

    /* Purchase Card - Floating Capsule */
    .purchase-card {
      position: fixed;
      top: 24px;
      right: 24px;
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: saturate(180%) blur(16px);
      -webkit-backdrop-filter: saturate(180%) blur(16px);
      padding: 6px 6px 6px 16px;
      border-radius: 99px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: var(--shadow-float);
      border: 1px solid rgba(255, 255, 255, 0.3);
      z-index: 100;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      text-decoration: none;
    }

    .purchase-card:hover {
      background: rgba(255, 255, 255, 0.8);
      transform: scale(1.04) translateY(1px);
      box-shadow: 0 12px 28px rgba(31, 38, 135, 0.15);
    }

    .purchase-info { display: flex; flex-direction: column; }
    .purchase-icon { display: none; } /* Hide icon for cleaner look */
    
    .purchase-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: 1px;
      letter-spacing: -0.01em;
    }
    
    .purchase-label {
      font-size: 10px;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.02em;
    }
    
    .purchase-price {
      display: none; /* Hide price in the text area */
    }

    .purchase-btn {
      background: #1d1d1f;
      color: white;
      padding: 8px 16px;
      border-radius: 99px;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }
    
    /* Mobile Responsiveness */
    @media (max-width: 640px) {
      body { padding: 16px; align-items: flex-start; }
      .container { padding: 32px 24px; margin-top: 60px; }
      .purchase-card { top: 16px; right: 16px; left: 16px; justify-content: space-between; }
      .header { margin-bottom: 32px; }
      .logo-area { width: 56px; height: 56px; font-size: 28px; }
      h1 { font-size: 24px; }
      .flow-steps { grid-template-columns: 1fr; gap: 24px; text-align: left; }
      .flow-step { display: flex; gap: 16px; align-items: flex-start; text-align: left; }
      .step-number { margin: 0; flex-shrink: 0; }
      .lang-selector { top: -150px; } /* Adjust based on new layout or hide */
    }
  </style>
</head>
<body>
  <!-- 购买卡密 (Floating) -->
  <a href="https://bearaiapp.com/" target="_blank" class="purchase-card">
    <div class="purchase-info">
      <div class="purchase-label" data-i18n="purchaseLabel">购买卡密</div>
      <div class="purchase-title" data-i18n="purchaseTitle">bearaiapp卡密小店</div>
    </div>
    <span class="purchase-btn" data-i18n="purchaseBtn">¥28 购买</span>
  </a>

  <div class="container">
    <header class="header">
      <!-- Minimalist Language Switcher inside header area (absolute) -->
      <div class="lang-selector">
        <button type="button" class="lang-btn" id="lang-btn">
          <span id="lang-text">中文</span> <span style="font-size:10px;">▼</span>
        </button>
        <div class="lang-dropdown" id="lang-dropdown">
          <div class="lang-option" data-lang="zh">中文</div>
          <div class="lang-option" data-lang="en">English</div>
          <div class="lang-option" data-lang="ru">Русский</div>
        </div>
      </div>

      <div class="logo-area">T</div>
      
      <h1>
        <span data-i18n="title">ChatGPT Team 邀请</span>
      </h1>
      <div class="badge" data-i18n="badge">客户端 · Web</div>
      <p class="subtitle" data-i18n="subtitle">输入卡密与邮箱，一键发送 ChatGPT Team 邀请。</p>
    </header>

    <form id="invite-form">
      <!-- 卡密 -->
      <div class="form-group">
        <label>
          <span data-i18n="cardKeyLabel">卡密</span>
          <span class="desc" data-i18n="cardKeyFormat">格式：XXXX-XXXX-XXXX</span>
        </label>
        <input
          id="card-key"
          type="text"
          class="input"
          data-i18n-placeholder="cardKeyPlaceholder"
          placeholder="输入卡密"
          autocomplete="off"
        />
        <!-- <div class="hint" data-i18n="cardKeyHint">自动格式化大写</div> -->
      </div>

      <!-- 邮箱 -->
      <div class="form-group">
        <label>
          <span data-i18n="emailLabel">邮箱</span>
          <span class="desc" data-i18n="emailPurpose">接收邀请</span>
        </label>
        <input
          id="email"
          type="email"
          class="input"
          data-i18n-placeholder="emailPlaceholder"
          placeholder="输入邮箱地址"
          autocomplete="email"
        />
      </div>

      <!-- 状态提示 -->
      <div id="status-box" class="status">
        <div class="status-icon" id="status-icon"></div>
        <div>
          <div class="status-title" id="status-title"></div>
          <div class="status-text" id="status-text"></div>
        </div>
      </div>

      <!-- 按钮 -->
      <div class="actions">
        <button type="button" id="reset-btn" class="btn-secondary" data-i18n="resetBtn">
          清空
        </button>
        <button type="submit" id="submit-btn" class="btn-primary">
          <span id="btn-text" data-i18n="sendBtn">发送邀请</span>
        </button>
      </div>
    </form>

    <div class="footer">
      <div data-i18n="footerNote">卡密仅限一次使用 · 请妥善保管<br/>提交后查收邮件</div>
    </div>

    <!-- 使用流程 -->
    <div class="usage-flow">
      <div class="usage-flow-title" data-i18n="flowTitle">使用流程</div>
      <div class="flow-steps">
        <div class="flow-step">
          <div class="step-number">1</div>
          <div class="step-title" data-i18n="step1Title">提交</div>
          <div class="step-desc" data-i18n="step1Desc">输入卡密和邮箱</div>
        </div>
        <div class="flow-step">
          <div class="step-number">2</div>
          <div class="step-title" data-i18n="step2Title">接收</div>
          <div class="step-desc" data-i18n="step2Desc">查收邀请邮件</div>
        </div>
        <div class="flow-step">
          <div class="step-number">3</div>
          <div class="step-title" data-i18n="step3Title">加入</div>
          <div class="step-desc" data-i18n="step3Desc">点击链接加入</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 国际化翻译
    const translations = {
      zh: {
        title: "ChatGPT Team 邀请",
        badge: "客户端 · Web",
        subtitle: "输入卡密与邮箱，一键发送 ChatGPT Team 邀请。",
        cardKeyLabel: "卡密",
        cardKeyFormat: "格式：XXXX-XXXX-XXXX 或 12位字符",
        cardKeyPlaceholder: "例如：ABCD-1234-EFGH 或 ABCD1234EFGH",
        cardKeyHint: "前端会自动去掉空格和横线，并转换为大写后再提交。",
        emailLabel: "邮箱",
        emailPurpose: "用于接收 Team 邀请邮件",
        emailPlaceholder: "例如：user@example.com",
        emailHint: "请确认邮箱可正常收信，避免被垃圾邮件拦截。",
        sendBtn: "发送邀请",
        sendingBtn: "发送中...",
        resetBtn: "清空",
        footerNote: "每个卡密仅可使用一次，请妥善保管<br/>提交成功后，请查收邮箱中的 ChatGPT Team 邀请邮件",
        errorCardEmpty: "卡密不能为空",
        errorCardEmptyText: "请输入卡密后再发送。",
        errorEmailEmpty: "邮箱不能为空",
        errorEmailEmptyText: "请输入用于接收邀请的邮箱地址。",
        errorEmailInvalid: "邮箱格式不正确",
        errorEmailInvalidText: "请检查邮箱格式，例如：user@example.com。",
        successTitle: "邀请发送成功",
        successText: "邀请已发送成功，请稍后查收邮箱中的 ChatGPT Team 邀请邮件。",
        errorBadRequest: "请求参数错误",
        errorBadRequestText: "请求参数错误，请检查卡密与邮箱是否正确。",
        errorNotFound: "接口不存在",
        errorNotFoundText: "未找到 /api/invite 接口，请检查 API 地址是否填写正确。",
        errorServer: "服务器错误",
        errorServerText: "服务器内部错误，请联系管理员或稍后重试。",
        errorRequestFailed: "请求失败",
        errorConnection: "无法连接到服务器",
        errorConnectionText: "请检查网络、API 地址是否可访问，或稍后重试。",
        flowTitle: "使用流程",
        step1Title: "提交兑换信息",
        step1Desc: "输入您的兑换码和邮箱地址",
        step2Title: "接收邀请邮件",
        step2Desc: "系统将自动发送邀请到您的邮箱",
        step3Title: "加入团队",
        step3Desc: "点击邮件中的链接即可完成加入",
        purchaseLabel: "购买卡密",
        purchaseTitle: "bearaiapp卡密小店",
        purchaseBtn: "立即购买"
      },
      en: {
        title: "ChatGPT Team Invitation",
        badge: "Client · Web",
        subtitle: "Enter your card key and email to send a ChatGPT Team invitation.",
        cardKeyLabel: "Card Key",
        cardKeyFormat: "Format: XXXX-XXXX-XXXX or 12 characters",
        cardKeyPlaceholder: "e.g., ABCD-1234-EFGH or ABCD1234EFGH",
        cardKeyHint: "Spaces and hyphens will be automatically removed and converted to uppercase.",
        emailLabel: "Email",
        emailPurpose: "For receiving Team invitation email",
        emailPlaceholder: "e.g., user@example.com",
        emailHint: "Please ensure your email can receive messages and avoid spam filters.",
        sendBtn: "Send Invitation",
        sendingBtn: "Sending...",
        resetBtn: "Clear",
        footerNote: "Each card key can only be used once, please keep it safe<br/>After successful submission, please check your email for the ChatGPT Team invitation",
        errorCardEmpty: "Card key is required",
        errorCardEmptyText: "Please enter your card key before sending.",
        errorEmailEmpty: "Email is required",
        errorEmailEmptyText: "Please enter your email address to receive the invitation.",
        errorEmailInvalid: "Invalid email format",
        errorEmailInvalidText: "Please check the email format, e.g., user@example.com.",
        successTitle: "Invitation Sent Successfully",
        successText: "The invitation has been sent successfully. Please check your email for the ChatGPT Team invitation.",
        errorBadRequest: "Bad Request",
        errorBadRequestText: "Invalid parameters. Please check your card key and email.",
        errorNotFound: "API Not Found",
        errorNotFoundText: "The /api/invite endpoint was not found. Please check the API address.",
        errorServer: "Server Error",
        errorServerText: "Internal server error. Please contact the administrator or try again later.",
        errorRequestFailed: "Request Failed",
        errorConnection: "Cannot Connect to Server",
        errorConnectionText: "Please check your network connection, API accessibility, or try again later.",
        flowTitle: "Usage Flow",
        step1Title: "Submit Information",
        step1Desc: "Enter your card key and email address",
        step2Title: "Receive Invitation",
        step2Desc: "The system will automatically send an invitation to your email",
        step3Title: "Join Team",
        step3Desc: "Click the link in the email to complete joining",
        purchaseLabel: "Purchase Card Key",
        purchaseTitle: "bearaiapp Card Store",
        purchaseBtn: "Buy Now"
      },
      ru: {
        title: "Приглашение ChatGPT Team",
        badge: "Клиент · Web",
        subtitle: "Введите ключ карты и email для отправки приглашения ChatGPT Team.",
        cardKeyLabel: "Ключ карты",
        cardKeyFormat: "Формат: XXXX-XXXX-XXXX или 12 символов",
        cardKeyPlaceholder: "например, ABCD-1234-EFGH или ABCD1234EFGH",
        cardKeyHint: "Пробелы и дефисы будут автоматически удалены и преобразованы в верхний регистр.",
        emailLabel: "Email",
        emailPurpose: "Для получения приглашения Team",
        emailPlaceholder: "например, user@example.com",
        emailHint: "Убедитесь, что ваш email может получать сообщения и не блокирует спам.",
        sendBtn: "Отправить приглашение",
        sendingBtn: "Отправка...",
        resetBtn: "Очистить",
        footerNote: "Каждый ключ карты можно использовать только один раз, храните его в безопасности<br/>После успешной отправки проверьте свою почту на наличие приглашения ChatGPT Team",
        errorCardEmpty: "Требуется ключ карты",
        errorCardEmptyText: "Пожалуйста, введите ключ карты перед отправкой.",
        errorEmailEmpty: "Требуется email",
        errorEmailEmptyText: "Пожалуйста, введите ваш email для получения приглашения.",
        errorEmailInvalid: "Неверный формат email",
        errorEmailInvalidText: "Пожалуйста, проверьте формат email, например, user@example.com.",
        successTitle: "Приглашение успешно отправлено",
        successText: "Приглашение успешно отправлено. Пожалуйста, проверьте вашу почту на наличие приглашения ChatGPT Team.",
        errorBadRequest: "Неверный запрос",
        errorBadRequestText: "Неверные параметры. Пожалуйста, проверьте ваш ключ карты и email.",
        errorNotFound: "API не найден",
        errorNotFoundText: "Конечная точка /api/invite не найдена. Пожалуйста, проверьте адрес API.",
        errorServer: "Ошибка сервера",
        errorServerText: "Внутренняя ошибка сервера. Пожалуйста, свяжитесь с администратором или попробуйте позже.",
        errorRequestFailed: "Запрос не выполнен",
        errorConnection: "Не удается подключиться к серверу",
        errorConnectionText: "Пожалуйста, проверьте подключение к сети, доступность API или попробуйте позже.",
        flowTitle: "Порядок использования",
        step1Title: "Отправить информацию",
        step1Desc: "Введите ваш ключ карты и адрес электронной почты",
        step2Title: "Получить приглашение",
        step2Desc: "Система автоматически отправит приглашение на вашу почту",
        step3Title: "Присоединиться к команде",
        step3Desc: "Нажмите на ссылку в письме, чтобы завершить присоединение",
        purchaseLabel: "Купить ключ карты",
        purchaseTitle: "Магазин bearaiapp",
        purchaseBtn: "Купить сейчас"
      }
    };

    let currentLang = localStorage.getItem('lang') || 'zh';

    const form = document.getElementById("invite-form");
    const cardInput = document.getElementById("card-key");
    const emailInput = document.getElementById("email");
    const statusBox = document.getElementById("status-box");
    const statusIcon = document.getElementById("status-icon");
    const statusTitle = document.getElementById("status-title");
    const statusText = document.getElementById("status-text");
    const submitBtn = document.getElementById("submit-btn");
    const btnText = document.getElementById("btn-text");
    const resetBtn = document.getElementById("reset-btn");
    const langBtn = document.getElementById("lang-btn");
    const langText = document.getElementById("lang-text");
    const langDropdown = document.getElementById("lang-dropdown");

    const DEFAULT_API = "https://team.8888822.xyz/api/invite";

    // 语言切换
    const langNames = { zh: '中文', en: 'English', ru: 'Русский' };
    
    function updateLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      langText.textContent = langNames[lang];
      
      // 更新所有带有 data-i18n 属性的元素
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
          el.innerHTML = translations[lang][key];
        }
      });
      
      // 更新所有带有 data-i18n-placeholder 属性的元素
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (translations[lang] && translations[lang][key]) {
          el.placeholder = translations[lang][key];
        }
      });
      
      // 更新语言选项的激活状态
      document.querySelectorAll('.lang-option').forEach(opt => {
        opt.classList.toggle('active', opt.getAttribute('data-lang') === lang);
      });
      
      // 更新页面标题
      document.title = translations[lang].title;
    }
    
    langBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      langDropdown.classList.toggle('show');
    });
    
    document.addEventListener('click', () => {
      langDropdown.classList.remove('show');
    });
    
    document.querySelectorAll('.lang-option').forEach(opt => {
      opt.addEventListener('click', (e) => {
        e.stopPropagation();
        const lang = opt.getAttribute('data-lang');
        updateLanguage(lang);
        langDropdown.classList.remove('show');
      });
    });
    
    // 初始化语言
    updateLanguage(currentLang);

    resetBtn.addEventListener("click", () => {
      cardInput.value = "";
      emailInput.value = "";
      hideStatus();
      clearErrors();
    });

    function showStatus(type, title, text) {
      statusBox.className = "status";
      if (type === "success") {
        statusBox.classList.add("status-success");
        statusIcon.textContent = "✓";
      } else if (type === "error") {
        statusBox.classList.add("status-error");
        statusIcon.textContent = "✗";
      }
      statusTitle.textContent = title || "";
      statusText.textContent = text || "";
      statusBox.style.display = "flex";
    }

    function hideStatus() {
      statusBox.style.display = "none";
    }

    function startLoading() {
      submitBtn.disabled = true;
      btnText.textContent = translations[currentLang].sendingBtn;
      hideStatus();
    }

    function stopLoading() {
      submitBtn.disabled = false;
      btnText.textContent = translations[currentLang].sendBtn;
      if (statusTitle.textContent) {
        statusBox.style.display = "flex";
      }
    }

    function clearErrors() {
      cardInput.classList.remove("error");
      emailInput.classList.remove("error");
    }

    function formatCardKey(raw) {
      const cleaned = (raw || "")
        .replace(/[^A-Za-z0-9]/g, "")
        .toUpperCase();
      if (cleaned.length === 12) {
        return cleaned.replace(/(.{4})(.{4})(.{4})/, "$1-$2-$3");
      }
      return cleaned;
    }

    function validateEmail(email) {
      // 更宽松的邮箱验证，支持各种域名邮箱格式
      const pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return pattern.test(email);
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      clearErrors();

      const apiUrl = DEFAULT_API;
      const cardRaw = cardInput.value.trim();
      const email = emailInput.value.trim();
      const t = translations[currentLang];

      if (!cardRaw) {
        cardInput.classList.add("error");
        showStatus("error", t.errorCardEmpty, t.errorCardEmptyText);
        return;
      }
      if (!email) {
        emailInput.classList.add("error");
        showStatus("error", t.errorEmailEmpty, t.errorEmailEmptyText);
        return;
      }
      if (!validateEmail(email)) {
        emailInput.classList.add("error");
        showStatus("error", t.errorEmailInvalid, t.errorEmailInvalidText);
        return;
      }

      const formattedKey = formatCardKey(cardRaw);

      startLoading();

      try {
        const resp = await fetch(apiUrl, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            card_key: formattedKey,
            email: email
          })
        });

        let data = null;
        try {
          data = await resp.json();
        } catch (err) {
          data = { message: await resp.text() };
        }

        if (resp.ok) {
          const msg = (data && data.message) || t.successText;
          showStatus("success", t.successTitle, msg);
        } else if (resp.status === 400) {
          const msg =
            (data && (data.message || (data.detail && data.detail.message))) ||
            t.errorBadRequestText;
          showStatus("error", t.errorBadRequest, msg);
        } else if (resp.status === 404) {
          showStatus("error", t.errorNotFound, t.errorNotFoundText);
        } else if (resp.status === 500) {
          const msg = (data && data.message) || t.errorServerText;
          showStatus("error", t.errorServer, msg);
        } else {
          const msg = (data && data.message) || `HTTP ${resp.status}`;
          showStatus("error", t.errorRequestFailed, msg);
        }
      } catch (err) {
        showStatus("error", t.errorConnection, t.errorConnectionText);
      } finally {
        stopLoading();
      }
    });
  </script>
</body>
</html>
